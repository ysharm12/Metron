Below is one example of how you can combine DuckDB with Azure OpenAI (using the OpenAI Python package configured for Azure) to create a natural‑language interface over CSV data. In this example, we:

1. Load the CSV into an in‑memory DuckDB table.
2. Retrieve the table schema.
3. Build a prompt that instructs the Azure OpenAI model to convert a natural language query into an SQL query.
4. Execute the generated SQL on the CSV data using DuckDB.

Make sure you’ve set up your Azure OpenAI endpoint, key, and version correctly.

```python
import duckdb
import openai

# Configure OpenAI to use your Azure OpenAI resource.
openai.api_type = "azure"
openai.api_base = "https://<your-resource-name>.openai.azure.com/"
openai.api_version = "2024-08-01-preview"
openai.api_key = "YOUR_API_KEY"

# Load CSV data into DuckDB (in-memory)
csv_path = "FINAL_DATA_28JAN2025_29.csv"
con = duckdb.connect(database=':memory:')
con.execute(f"CREATE TABLE data AS SELECT * FROM read_csv_auto('{csv_path}');")

# Get the table schema to inform the LLM
schema = con.execute("DESCRIBE data").fetchdf().to_string(index=False)

# Natural language query to convert into SQL
nl_query = "Calculate the total revenue and average sales per month."

# Construct a prompt to instruct the model
prompt = f"""
You are a SQL generator.
Given the following table schema:
{schema}

Write a SQL query that fulfills this request:
"{nl_query}"

Provide only the SQL query.
"""

# Call the Azure OpenAI API to generate the SQL query.
response = openai.Completion.create(
    engine="gpt-35-turbo",  # Make sure this is a supported deployment/model in your Azure resource.
    prompt=prompt,
    max_tokens=150,
    temperature=0,
    stop=["\n"]
)

sql_query = response.choices[0].text.strip()
print("Generated SQL Query:")
print(sql_query)

# Execute the generated SQL query using DuckDB
result = con.execute(sql_query).fetchdf()
print("Query Result:")
print(result)
```

### Explanation

- **DuckDB Integration:**  
  We create an in‑memory DuckDB connection and load the CSV file using `read_csv_auto`. The schema is then extracted (using `DESCRIBE data`) to include in the prompt.

- **Azure OpenAI for NL2SQL:**  
  The prompt asks the model to generate an SQL query that meets the natural language request. (Make sure your deployment (here, `"gpt-35-turbo"`) supports the completion operation as noted in Azure documentation.)

- **Executing the Query:**  
  Once the SQL query is generated, it’s executed against the DuckDB table, and the results are printed.

This approach avoids using LangChain or Pandas directly and leverages open‑source DuckDB together with Azure OpenAI for converting natural language into a query. Adjust the prompt, model parameters, and engine name as needed for your environment.
